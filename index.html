<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Googleスプレッドシートの内容をjsonデータとして利用する</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>
<div id="whole">
<!-- // -->
</div>
<script>
// ページ読み込み後の処理
window.onload = function(){
	// 【main-script】 を実行
	getJsonp_GAS();
}

// 【main-script】 スプレッドシート内の記述をjsonデータとして読み込み html 内へ入れ込む
//変更後
//変更後
function getJsonp_GAS() {
	// 1秒おきにデータをロード
	setInterval(function(){
		$.ajax({
			type: 'GET',
			url: 'https://script.google.com/macros/s/AKfycbwoxHZ-qhoZCqJXZqYOVYoI2g9ILZ_bJo4dmr8IdXSGEjazh5Hlt_mRYkKCV5otVQPpjQ/exec',
			dataType: 'jsonp',
			jsonpCallback: 'jsondata',
			success: function(json){
				//JSONデータが取得された場合
				if(json){
					var len = json.length;
					// 最後に入力された値だけを取得
					var score = json[len - 1].どれくらい楽しかったですか;
					// html要素のinnerHTML属性に設定
					document.getElementById('whole').innerHTML = score + '<br>';
				}else{
					//JSONデータを取得されなかった場合
					// HTML要素のinnerHTML属性を空に設定
					document.getElementById('whole').innerHTML = '';
				}
			}
		});
	}, 100);
}

// JSONデータが取得できなかった場合、HTML要素のinnerHTML属性を空に設定
if(json === undefined){
	document.getElementById('whole').innerHTML = '';
}



</script>
</body>
</html>